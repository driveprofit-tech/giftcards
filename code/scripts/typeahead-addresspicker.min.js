(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,o=function(e,o){function r(){this.constructor=e}for(var s in o)t.call(o,s)&&(e[s]=o[s]);return r.prototype=o.prototype,e.prototype=new r,e.__super__=o.prototype,e};!function(t){this.AddressPickerResult=function(){function e(e,t){this.placeResult=e,this.fromReverseGeocoding=null!=t&&t,this.latitude=this.placeResult.geometry.location.lat(),this.longitude=this.placeResult.geometry.location.lng()}return e.prototype.addressTypes=function(){var e,t,o,r,s,i,n,a;for(t=[],o=0,s=(n=this.addressComponents()).length;o<s;o++)for(r=0,i=(a=n[o].types).length;r<i;r++)e=a[r],-1===t.indexOf(e)&&t.push(e);return t},e.prototype.addressComponents=function(){return this.placeResult.address_components||[]},e.prototype.address=function(){return this.placeResult.formatted_address},e.prototype.nameForType=function(e,t){var o,r,s,i;for(null==t&&(t=!1),r=0,s=(i=this.addressComponents()).length;r<s;r++)if(-1!==(o=i[r]).types.indexOf(e))return t?o.short_name:o.long_name;return null},e.prototype.lat=function(){return this.latitude},e.prototype.lng=function(){return this.longitude},e.prototype.setLatLng=function(e,t){this.latitude=e,this.longitude=t},e.prototype.isAccurate=function(){return!this.placeResult.geometry.viewport},e.prototype.isReverseGeocoding=function(){return this.fromReverseGeocoding},e}(),this.AddressPicker=function(r){function s(o){null==o&&(o={});var r=o.lat,i=o.lng,n=new google.maps.LatLng(r,i);this.markerDragged=e(this.markerDragged,this),this.updateBoundsForPlace=e(this.updateBoundsForPlace,this),this.updateMap=e(this.updateMap,this),this.options=t.extend({local:[],datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.num)},queryTokenizer:Bloodhound.tokenizers.whitespace,autocompleteService:{location:n,radius:1e5,types:["establishment","geocode"],rankBy:google.maps.places.RankBy.DISTANCE},zoomForLocation:16,reverseGeocoding:!1,placeDetails:!0},o),s.__super__.constructor.call(this,this.options),this.options.map&&this.initMap(),this.placeService=new google.maps.places.PlacesService(document.createElement("div"))}return o(s,r),s.prototype.bindDefaultTypeaheadEvent=function(e){return e.bind("typeahead:selected",this.updateMap),e.bind("typeahead:cursorchanged",this.updateMap)},s.prototype.initMap=function(){var e,o,r;if((null!=(o=this.options)&&null!=(r=o.map)?r.gmap:void 0)?this.map=this.options.map.gmap:(this.mapOptions=t.extend({zoom:3,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP,boundsForLocation:this.updateBoundsForPlace},this.options.map),this.map=new google.maps.Map(t(this.mapOptions.id)[0],this.mapOptions)),this.lastResult=null,e=t.extend({draggable:!0,visible:!1,position:this.map.getCenter(),map:this.map},this.options.marker||{}),this.marker=new google.maps.Marker(e),e.draggable)return google.maps.event.addListener(this.marker,"dragend",this.markerDragged)},s.prototype.get=function(e,o){var r;return r=new google.maps.places.AutocompleteService,this.options.autocompleteService.input=e,r.getPlacePredictions(this.options.autocompleteService,function(e){return function(r){return t(e).trigger("addresspicker:predictions",[r]),o(r)}}(this))},s.prototype.updateMap=function(e,o){return this.options.placeDetails?this.placeService.getDetails(o,function(e){return function(o){var r;return e.lastResult=new AddressPickerResult(o),e.marker&&(e.marker.setPosition(o.geometry.location),e.marker.setVisible(!0)),e.map&&null!=(r=e.mapOptions)&&r.boundsForLocation(o),t(e).trigger("addresspicker:selected",e.lastResult)}}(this)):t(this).trigger("addresspicker:selected",o)},s.prototype.updateBoundsForPlace=function(e){return e.geometry.viewport?this.map.fitBounds(e.geometry.viewport):(this.map.setCenter(e.geometry.location),this.map.setZoom(this.options.zoomForLocation))},s.prototype.markerDragged=function(){return this.options.reverseGeocoding?this.reverseGeocode(this.marker.getPosition()):(this.lastResult?this.lastResult.setLatLng(this.marker.getPosition().lat(),this.marker.getPosition().lng()):this.lastResult=new AddressPickerResult({geometry:{location:this.marker.getPosition()}}),t(this).trigger("addresspicker:selected",this.lastResult))},s.prototype.reverseGeocode=function(e){return null==this.geocoder&&(this.geocoder=new google.maps.Geocoder),this.geocoder.geocode({location:e},function(e){return function(o){if(o&&o.length>0)return e.lastResult=new AddressPickerResult(o[0],!0),t(e).trigger("addresspicker:selected",e.lastResult)}}(this))},s.prototype.getGMap=function(){return this.map},s.prototype.getGMarker=function(){return this.marker},s}(Bloodhound)}(jQuery)}).call(this);